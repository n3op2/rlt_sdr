{"ast":null,"code":"var _jsxFileName = \"/home/n3op2/node/sdrf_client/src/App.js\";\nimport React, { Fragment, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport axios from 'axios';\n\nconst Heatmap = () => {\n  useEffect(() => {\n    const url = 'http://localhost:3010';\n    axios.get(url).then(res => {\n      const data = res.data.freqs,\n            baseTemperature = 153384000,\n            timeRange = d3.extent(data, d => d.createdAt);\n      const legendData = [{\n        'interval': 2.7,\n        'color': 'purple'\n      }, {\n        'interval': 3.9,\n        'color': 'darkorchid'\n      }, {\n        'interval': 6.1,\n        'color': 'mediumpurple'\n      }, {\n        'interval': 7.2,\n        'color': 'lightskyblue'\n      }, {\n        'interval': 8.3,\n        'color': 'khaki'\n      }, {\n        'interval': 9.4,\n        'color': 'orange'\n      }, {\n        'interval': 10.5,\n        'color': 'salmon'\n      }, {\n        'interval': 11.6,\n        'color': 'indianred'\n      }, {\n        'interval': 15,\n        'color': 'darkred'\n      }];\n      const width = 917,\n            height = 408,\n            margins = {\n        top: 20,\n        right: 50,\n        bottom: 100,\n        left: 100\n      };\n      const yScale = d3.scaleLinear().range([height, 0]).domain([12, 0]);\n      const xScale = d3.scaleLinear().range([0, width]).domain(d3.extent(data, d => {\n        return d.year;\n      })); //Setting chart width and adjusting for margins\n\n      const chart = d3.select('.chart').attr('width', width + margins.right + margins.left).attr('height', height + margins.top + margins.bottom).append('g').attr('transform', 'translate(' + margins.left + ',' + margins.top + ')');\n      const tooltip = d3.select('.container').append('div').attr('class', 'tooltip').html('Tooltip');\n      const barWidth = width / (yearRange[1] - yearRange[0]),\n            barHeight = height / 12; //Return dynamic color based on intervals in legendData\n\n      const colorScale = d => {\n        for (let i = 0; i < legendData.length; i++) {\n          if (d.variance + baseTemperature < legendData[i].interval) {\n            return legendData[i].color;\n          }\n        }\n\n        return 'darkred';\n      }; //Return abbreviate month string from month decimal\n\n\n      const timeParseFormat = d => {\n        if (d === 0) return '';\n        return d3.timeFormat('%b')(d3.timeParse('%m')(d));\n      }; //Append heatmap bars, styles, and mouse events\n\n\n      chart.selectAll('g').data(data).enter().append('g').append('rect').attr('x', d => {\n        return (d.year - yearRange[0]) * barWidth;\n      }).attr('y', d => {\n        return (d.month - 1) * barHeight;\n      }).style('fill', colorScale).attr('width', barWidth).attr('height', barHeight).on('mouseover', d => {\n        tooltip.html(timeParseFormat(d.month) + ' ' + d.year + '<br/>' + d3.format('.4r')(baseTemperature + d.variance) + ' &degC<br/>' + d.variance + ' &degC').style('left', d3.event.pageX - 35 + 'px').style('top', d3.event.pageY - 73 + 'px').style('opacity', .9);\n      }).on('mouseout', () => {\n        tooltip.style('opacity', 0).style('left', '0px');\n      }); //Append x axis\n\n      chart.append('g').attr('transform', 'translate(0,' + height + ')').call(d3.axisBottom(xScale).tickFormat(d3.format('.4'))); //Append y axis\n\n      chart.append('g').attr('transform', 'translate(0,-' + barHeight / 2 + ')').call(d3.axisLeft(yScale).tickFormat(timeParseFormat)).attr('class', 'yAxis'); //Append y axis label\n\n      chart.append('text').attr('transform', 'translate(-40,' + height / 2 + ') rotate(-90)').style('text-anchor', 'middle').text('Month'); //Append x axis label\n\n      chart.append('text').attr('transform', 'translate(' + width / 2 + ',' + (height + 40) + ')').style('text-anchor', 'middle').text('Year'); //Append color legend using legendData\n\n      chart.append('g').selectAll('g').data(legendData).enter().append('rect').attr('width', 30).attr('height', 20).attr('x', (d, i) => {\n        return i * 30 + width * .7;\n      }).attr('y', height + margins.top).style('fill', d => {\n        return d.color;\n      }); //Append text labels for legend from legendData\n\n      chart.append('g').selectAll('text').data(legendData).enter().append('text').attr('x', (d, i) => {\n        return i * 30 + width * .7;\n      }).attr('y', height + margins.top * 3).text(d => {\n        return d.interval;\n      });\n    });\n  }, []);\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"Heatmap\"));\n};\n\nconst App = () => {\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(Heatmap, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/n3op2/node/sdrf_client/src/App.js"],"names":["React","Fragment","useEffect","d3","axios","Heatmap","url","get","then","res","data","freqs","baseTemperature","timeRange","extent","d","createdAt","legendData","width","height","margins","top","right","bottom","left","yScale","scaleLinear","range","domain","xScale","year","chart","select","attr","append","tooltip","html","barWidth","yearRange","barHeight","colorScale","i","length","variance","interval","color","timeParseFormat","timeFormat","timeParse","selectAll","enter","month","style","on","format","event","pageX","pageY","call","axisBottom","tickFormat","axisLeft","text","App"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport axios from 'axios';\n\nconst Heatmap = () => {\n\n  useEffect(() => {\n    const url = 'http://localhost:3010';\n    axios.get(url).then( res => {\n\n      const data = res.data.freqs,\n            baseTemperature = 153384000,\n            timeRange = d3.extent(data, d => d.createdAt);\n\n      const legendData = [\n        {'interval': 2.7, 'color': 'purple'},\n        {'interval': 3.9, 'color': 'darkorchid'},\n        {'interval': 6.1, 'color': 'mediumpurple'},\n        {'interval': 7.2, 'color': 'lightskyblue'},\n        {'interval': 8.3, 'color': 'khaki'},\n        {'interval': 9.4, 'color': 'orange'},\n        {'interval': 10.5, 'color': 'salmon'},\n        {'interval': 11.6, 'color': 'indianred'},\n        {'interval': 15,'color': 'darkred'}\n      ];\n      \n      const width = 917,\n            height = 408,\n            margins = {top:20, right: 50, bottom: 100, left: 100};\n      \n      const yScale = d3.scaleLinear()\n        .range([height,0])\n        .domain([12,0]);\n      \n      const xScale = d3.scaleLinear()\n        .range([0,width])\n        .domain(d3.extent(data, d => {return d.year; }));\n      \n      //Setting chart width and adjusting for margins\n      const chart = d3.select('.chart')\n        .attr('width', width + margins.right + margins.left)\n        .attr('height', height + margins.top + margins.bottom)\n        .append('g')\n        .attr('transform','translate(' + margins.left + ',' + margins.top + ')');\n      \n      const tooltip = d3.select('.container').append('div')\n        .attr('class','tooltip')\n        .html('Tooltip')\n      \n      const barWidth = width / (yearRange[1] - yearRange[0]),\n            barHeight = height / 12;\n      \n      //Return dynamic color based on intervals in legendData\n      const colorScale = d => {\n        for (let i = 0; i < legendData.length; i++) {\n          if (d.variance + baseTemperature < legendData[i].interval) {\n            return legendData[i].color;\n          }\n        }\n        return 'darkred';\n      };\n      \n      //Return abbreviate month string from month decimal\n      const timeParseFormat = d => {\n        if (d === 0) return '';\n        return d3.timeFormat('%b')(d3.timeParse('%m')(d));\n      };\n      \n      //Append heatmap bars, styles, and mouse events\n      chart.selectAll('g')\n        .data(data).enter().append('g')\n        .append('rect')\n        .attr('x', d => {return (d.year - yearRange[0]) * barWidth})\n        .attr('y', d => {return (d.month - 1) * barHeight})\n        .style('fill', colorScale)\n        .attr('width', barWidth)\n        .attr('height', barHeight)\n        .on('mouseover', d => {\n          tooltip.html(timeParseFormat(d.month) + ' ' + d.year + '<br/>' +\n            d3.format('.4r')(baseTemperature + d.variance) + ' &degC<br/>' + d.variance + ' &degC' )\n            .style('left', d3.event.pageX - 35 + 'px')\n            .style('top', d3.event.pageY - 73 + 'px')\n            .style('opacity', .9);\n        }).on('mouseout', () => {\n          tooltip.style('opacity', 0)\n            .style('left', '0px');\n        });\n      \n      //Append x axis\n      chart.append('g')\n        .attr('transform','translate(0,' + height + ')')\n        .call(d3.axisBottom(xScale).tickFormat(d3.format('.4')));\n      \n      //Append y axis\n      chart.append('g')\n        .attr('transform','translate(0,-' + barHeight / 2 + ')')\n        .call(d3.axisLeft(yScale).tickFormat(timeParseFormat))\n        .attr('class','yAxis');\n      \n      //Append y axis label\n      chart.append('text')\n        .attr('transform','translate(-40,' + (height / 2)  + ') rotate(-90)')\n        .style('text-anchor','middle')\n        .text('Month');\n      \n      //Append x axis label\n      chart.append('text')\n        .attr('transform','translate(' + (width / 2) + ',' + (height + 40) + ')')\n        .style('text-anchor','middle')\n        .text('Year');\n      \n      //Append color legend using legendData\n      chart.append('g')\n        .selectAll('g')\n        .data(legendData).enter()\n        .append('rect')\n        .attr('width', 30)\n        .attr('height', 20)\n        .attr('x', (d, i) => { return i * 30 + width * .7;})\n        .attr('y', height + margins.top)\n        .style('fill', d => {return d.color; });\n      \n      //Append text labels for legend from legendData\n      chart.append('g')\n        .selectAll('text')\n        .data(legendData).enter().append('text')\n        .attr('x', (d,i) => {return i * 30 + width * .7})\n        .attr('y', height + margins.top * 3)\n        .text(d => {return d.interval; });\n        \n    });\n  }, []);\n\n  return (\n    <Fragment>\n      <h1>Heatmap</h1>\n    </Fragment>\n  );\n};\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <Heatmap />\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}