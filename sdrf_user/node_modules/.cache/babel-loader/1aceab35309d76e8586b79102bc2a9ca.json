{"ast":null,"code":"import _slicedToArray from \"/home/n3op2/node/sdrf_client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/n3op2/node/sdrf_client/src/App.js\";\nimport React, { Fragment, useEffect, useState } from 'react';\nimport * as d3 from 'd3';\nimport axios from 'axios';\n\nconst Heatmap = () => {\n  const url = 'http://localhost:3010';\n\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        data = _useState2[0],\n        setData = _useState2[1];\n\n  const getData = async () => {\n    const response = await axios.get(url);\n    setData(response.data);\n    await new Promise(r => setTimeout(r, 3000));\n    console.log('res: ', response);\n    console.log('data: ', data);\n  };\n\n  useEffect(() => {\n    console.log('useEffect()');\n    getData();\n    console.log('data: ', data);\n    /*\n    axios.get(url).then(res => {\n      console.log('fetching data...');\n      // TODO have a separate table for data values such as\n      // hzLow, hzHigh and link it with freqs id\n      if (res.data) {\n        // TODO tidy up\n        const data = res.data;\n        const baseHz = res.data[0].hzLow;\n        const topHz = res.data[0].hzHigh;\n        const baseTemperature = res.data[0].hzLow;\n        const step = (topHz - baseHz) / res.data[0].freqs.length;\n        let hz = baseHz;\n        const dataVis = [];\n         const mappedData = data.map((el, i) => {\n          console.log('started');\n          hz = baseHz;\n          return el.freqs.map((db) => {\n            const tmp = {};\n            tmp.createdAt = el.createdAt;\n            tmp.db = db;\n            tmp.hz = hz;\n            hz = Math.round(hz + step);\n            dataVis.push(tmp);\n            return tmp;\n          });\n        });\n         console.log('top: ', topHz, '\\nbase: ', baseHz);\n         // TODO move it to a separate function\n        const hzRange = [baseHz, topHz]; \n        const margin = {top: 100, right: 50, bottom: 100, left: 50};\n        const width = 9450 - margin.left - margin.right;\n        const height = 950 - margin.top - margin.bottom;\n         const svg = d3.select('.chart')\n          .attr('width', width + margin.left + margin.right)\n          .attr('height', height + margin.top + margin.bottom)\n          .append('g')\n          .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n         const xScale = d3.scaleBand()\n          .range([0, width])\n          .domain(mappedData[0].map(d => {\n            return d.hz;\n          }))\n          .padding(0.01);\n         svg.append('g')\n          .attr('transform', 'translate(0,' + height + ')')\n          .call(d3.axisBottom(xScale)\n            .ticks(30, 's'))\n          .attr('class','xAxis');\n          const yScale = d3.scaleBand()\n          .range([ height, 0 ])\n          .domain(mappedData.map((el) => el.map((item) => item.createdAt)\n            .filter((v, i, a) => a.indexOf(v) === i)[0]))\n          .padding(0.01);\n         svg.append(\"g\")\n          .call(d3.axisLeft(yScale))\n          .attr('class','yAxis');\n         svg.append('text')\n          .attr('transform','translate(' + (width / 2) + ',' + (height + 40) + ')')\n          .style('text-anchor','middle')\n          .text('HZ');\n         const colorScale = d3.scaleLinear()\n          .range(['blue', 'yellow', 'red'])\n          .domain([-127, 0, 127]);\n        \n        svg.selectAll('g.x text')\n          .attr('transform', 'translate(-10,10) rotate(315)');\n         svg.selectAll()\n            .data(dataVis)\n            .enter()\n            .append(\"rect\")\n            .attr(\"x\", function(d) { \n              return xScale(d.hz) \n            })\n            .attr(\"y\", function(d) { \n              return yScale(d.createdAt) \n            })\n            .attr(\"width\", xScale.bandwidth() )\n            .attr(\"height\", yScale.bandwidth() )\n            .style(\"fill\", function(d) { return colorScale(d.db)} )\n      \n        svg.selectAll('g.x')\n          .attr('transform', 'translate(-10,10) rotate(315)');\n      }\n    });\n    */\n  }, ['data']);\n\n  if (data !== 'asd') {\n    console.log('aaaa');\n    setData('asd');\n  }\n\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, \"Heatmap\"), React.createElement(\"svg\", {\n    className: \"chart\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }));\n};\n\nconst App = () => {\n  return React.createElement(\"div\", {\n    style: {\n      height: '100%'\n    },\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(Heatmap, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/n3op2/node/sdrf_client/src/App.js"],"names":["React","Fragment","useEffect","useState","d3","axios","Heatmap","url","data","setData","getData","response","get","Promise","r","setTimeout","console","log","App","height"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,QAArC,QAAqD,OAArD;AACA,OAAO,KAAKC,EAAZ,MAAoB,IAApB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,MAAMC,OAAO,GAAG,MAAM;AACpB,QAAMC,GAAG,GAAG,uBAAZ;;AADoB,oBAEIJ,QAAQ,CAAC,IAAD,CAFZ;AAAA;AAAA,QAEbK,IAFa;AAAA,QAEPC,OAFO;;AAIpB,QAAMC,OAAO,GAAG,YAAY;AAC1B,UAAMC,QAAQ,GAAG,MAAMN,KAAK,CAACO,GAAN,CAAUL,GAAV,CAAvB;AACAE,IAAAA,OAAO,CAACE,QAAQ,CAACH,IAAV,CAAP;AACA,UAAM,IAAIK,OAAJ,CAAaC,CAAD,IAAOC,UAAU,CAACD,CAAD,EAAI,IAAJ,CAA7B,CAAN;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBN,QAArB;AACAK,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBT,IAAtB;AACD,GAND;;AAQAN,EAAAA,SAAS,CAAC,MAAM;AACdc,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAP,IAAAA,OAAO;AACPM,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBT,IAAtB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkGD,GAtGQ,EAsGN,CAAC,MAAD,CAtGM,CAAT;;AAwGA,MAAIA,IAAI,KAAK,KAAb,EAAoB;AAClBQ,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACAR,IAAAA,OAAO,CAAC,KAAD,CAAP;AACD;;AAED,SACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,EAEE;AAAK,IAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF;AAMD,CA/HD;;AAiIA,MAAMS,GAAG,GAAG,MAAM;AAChB,SACE;AAAK,IAAA,KAAK,EAAE;AAACC,MAAAA,MAAM,EAAE;AAAT,KAAZ;AAA8B,IAAA,SAAS,EAAC,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF;AAKD,CAND;;AAQA,eAAeD,GAAf","sourcesContent":["import React, { Fragment, useEffect, useState } from 'react';\nimport * as d3 from 'd3';\nimport axios from 'axios';\n\nconst Heatmap = () => {\n  const url = 'http://localhost:3010';\n  const [data, setData] = useState(null);\n   \n  const getData = async () => {\n    const response = await axios.get(url);\n    setData(response.data);\n    await new Promise((r) => setTimeout(r, 3000));\n    console.log('res: ', response);\n    console.log('data: ', data);\n  };\n\n  useEffect(() => {\n    console.log('useEffect()');\n    getData();\n    console.log('data: ', data);\n    /*\n    axios.get(url).then(res => {\n      console.log('fetching data...');\n      // TODO have a separate table for data values such as\n      // hzLow, hzHigh and link it with freqs id\n      if (res.data) {\n        // TODO tidy up\n        const data = res.data;\n        const baseHz = res.data[0].hzLow;\n        const topHz = res.data[0].hzHigh;\n        const baseTemperature = res.data[0].hzLow;\n        const step = (topHz - baseHz) / res.data[0].freqs.length;\n        let hz = baseHz;\n        const dataVis = [];\n\n        const mappedData = data.map((el, i) => {\n          console.log('started');\n          hz = baseHz;\n          return el.freqs.map((db) => {\n            const tmp = {};\n            tmp.createdAt = el.createdAt;\n            tmp.db = db;\n            tmp.hz = hz;\n            hz = Math.round(hz + step);\n            dataVis.push(tmp);\n            return tmp;\n          });\n        });\n\n        console.log('top: ', topHz, '\\nbase: ', baseHz);\n\n        // TODO move it to a separate function\n        const hzRange = [baseHz, topHz]; \n        const margin = {top: 100, right: 50, bottom: 100, left: 50};\n        const width = 9450 - margin.left - margin.right;\n        const height = 950 - margin.top - margin.bottom;\n\n        const svg = d3.select('.chart')\n          .attr('width', width + margin.left + margin.right)\n          .attr('height', height + margin.top + margin.bottom)\n          .append('g')\n          .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n        const xScale = d3.scaleBand()\n          .range([0, width])\n          .domain(mappedData[0].map(d => {\n            return d.hz;\n          }))\n          .padding(0.01);\n\n        svg.append('g')\n          .attr('transform', 'translate(0,' + height + ')')\n          .call(d3.axisBottom(xScale)\n            .ticks(30, 's'))\n          .attr('class','xAxis');\n\n\n        const yScale = d3.scaleBand()\n          .range([ height, 0 ])\n          .domain(mappedData.map((el) => el.map((item) => item.createdAt)\n            .filter((v, i, a) => a.indexOf(v) === i)[0]))\n          .padding(0.01);\n\n        svg.append(\"g\")\n          .call(d3.axisLeft(yScale))\n          .attr('class','yAxis');\n\n        svg.append('text')\n          .attr('transform','translate(' + (width / 2) + ',' + (height + 40) + ')')\n          .style('text-anchor','middle')\n          .text('HZ');\n\n        const colorScale = d3.scaleLinear()\n          .range(['blue', 'yellow', 'red'])\n          .domain([-127, 0, 127]);\n        \n        svg.selectAll('g.x text')\n          .attr('transform', 'translate(-10,10) rotate(315)');\n\n        svg.selectAll()\n            .data(dataVis)\n            .enter()\n            .append(\"rect\")\n            .attr(\"x\", function(d) { \n              return xScale(d.hz) \n            })\n            .attr(\"y\", function(d) { \n              return yScale(d.createdAt) \n            })\n            .attr(\"width\", xScale.bandwidth() )\n            .attr(\"height\", yScale.bandwidth() )\n            .style(\"fill\", function(d) { return colorScale(d.db)} )\n      \n        svg.selectAll('g.x')\n          .attr('transform', 'translate(-10,10) rotate(315)');\n      }\n    });\n    */\n  }, ['data']);\n\n  if (data !== 'asd') {\n    console.log('aaaa');\n    setData('asd');\n  }\n\n  return (\n    <Fragment>\n      <h1>Heatmap</h1>\n      <svg className='chart'></svg>\n    </Fragment>\n  );\n};\n\nconst App = () => {\n  return (\n    <div style={{height: '100%'}} className=\"App\">\n      <Heatmap />\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}