{"ast":null,"code":"var _jsxFileName = \"/home/n3op2/node/sdrf_client/src/App.js\";\nimport React, { Fragment, useEffect } from 'react';\nimport * as d3 from 'd3';\n\nconst Heatmap = () => {\n  useEffect(() => {\n    const url = 'http://localhost:3010';\n    axios.get(url).then(res => {\n      const data = res.data.monthlyVariance,\n            baseTemperature = res.data.baseTemperature,\n            yearRange = d3.extent(data, d => {\n        return d.year;\n      });\n      const legendData = [{\n        'interval': 2.7,\n        'color': 'purple'\n      }, {\n        'interval': 3.9,\n        'color': 'darkorchid'\n      }, {\n        'interval': 6.1,\n        'color': 'mediumpurple'\n      }, {\n        'interval': 7.2,\n        'color': 'lightskyblue'\n      }, {\n        'interval': 8.3,\n        'color': 'khaki'\n      }, {\n        'interval': 9.4,\n        'color': 'orange'\n      }, {\n        'interval': 10.5,\n        'color': 'salmon'\n      }, {\n        'interval': 11.6,\n        'color': 'indianred'\n      }, {\n        'interval': 15,\n        'color': 'darkred'\n      }];\n      const width = 917,\n            height = 408,\n            margins = {\n        top: 20,\n        right: 50,\n        bottom: 100,\n        left: 100\n      };\n      const yScale = d3.scaleLinear().range([height, 0]).domain([12, 0]);\n      const xScale = d3.scaleLinear().range([0, width]).domain(d3.extent(data, d => {\n        return d.year;\n      })); //Setting chart width and adjusting for margins\n\n      const chart = d3.select('.chart').attr('width', width + margins.right + margins.left).attr('height', height + margins.top + margins.bottom).append('g').attr('transform', 'translate(' + margins.left + ',' + margins.top + ')');\n      const tooltip = d3.select('.container').append('div').attr('class', 'tooltip').html('Tooltip');\n      const barWidth = width / (yearRange[1] - yearRange[0]),\n            barHeight = height / 12; //Return dynamic color based on intervals in legendData\n\n      const colorScale = d => {\n        for (let i = 0; i < legendData.length; i++) {\n          if (d.variance + baseTemperature < legendData[i].interval) {\n            return legendData[i].color;\n          }\n        }\n\n        return 'darkred';\n      }; //Return abbreviate month string from month decimal\n\n\n      const timeParseFormat = d => {\n        if (d === 0) return '';\n        return d3.timeFormat('%b')(d3.timeParse('%m')(d));\n      }; //Append heatmap bars, styles, and mouse events\n\n\n      chart.selectAll('g').data(data).enter().append('g').append('rect').attr('x', d => {\n        return (d.year - yearRange[0]) * barWidth;\n      }).attr('y', d => {\n        return (d.month - 1) * barHeight;\n      }).style('fill', colorScale).attr('width', barWidth).attr('height', barHeight).on('mouseover', d => {\n        tooltip.html(timeParseFormat(d.month) + ' ' + d.year + '<br/>' + d3.format('.4r')(baseTemperature + d.variance) + ' &degC<br/>' + d.variance + ' &degC').style('left', d3.event.pageX - 35 + 'px').style('top', d3.event.pageY - 73 + 'px').style('opacity', .9);\n      }).on('mouseout', () => {\n        tooltip.style('opacity', 0).style('left', '0px');\n      }); //Append x axis\n\n      chart.append('g').attr('transform', 'translate(0,' + height + ')').call(d3.axisBottom(xScale).tickFormat(d3.format('.4'))); //Append y axis\n\n      chart.append('g').attr('transform', 'translate(0,-' + barHeight / 2 + ')').call(d3.axisLeft(yScale).tickFormat(timeParseFormat)).attr('class', 'yAxis'); //Append y axis label\n\n      chart.append('text').attr('transform', 'translate(-40,' + height / 2 + ') rotate(-90)').style('text-anchor', 'middle').text('Month'); //Append x axis label\n\n      chart.append('text').attr('transform', 'translate(' + width / 2 + ',' + (height + 40) + ')').style('text-anchor', 'middle').text('Year'); //Append color legend using legendData\n\n      chart.append('g').selectAll('g').data(legendData).enter().append('rect').attr('width', 30).attr('height', 20).attr('x', (d, i) => {\n        return i * 30 + width * .7;\n      }).attr('y', height + margins.top).style('fill', d => {\n        return d.color;\n      }); //Append text labels for legend from legendData\n\n      chart.append('g').selectAll('text').data(legendData).enter().append('text').attr('x', (d, i) => {\n        return i * 30 + width * .7;\n      }).attr('y', height + margins.top * 3).text(d => {\n        return d.interval;\n      });\n    });\n  }, []);\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"Heatmap\"));\n};\n\nconst App = () => {\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(Heatmap, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/n3op2/node/sdrf_client/src/App.js"],"names":["React","Fragment","useEffect","d3","Heatmap","url","axios","get","then","res","data","monthlyVariance","baseTemperature","yearRange","extent","d","year","legendData","width","height","margins","top","right","bottom","left","yScale","scaleLinear","range","domain","xScale","chart","select","attr","append","tooltip","html","barWidth","barHeight","colorScale","i","length","variance","interval","color","timeParseFormat","timeFormat","timeParse","selectAll","enter","month","style","on","format","event","pageX","pageY","call","axisBottom","tickFormat","axisLeft","text","App"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect } from 'react';\nimport * as d3 from 'd3';\n\nconst Heatmap = () => {\n\n  useEffect(() => {\n    const url = 'http://localhost:3010';\n    \n    axios.get(url).then( res => {\n      \n      const data = res.data.monthlyVariance,\n            baseTemperature = res.data.baseTemperature,\n            yearRange = d3.extent(data, d => {return d.year; });\n      \n      const legendData = [\n        {'interval': 2.7, 'color': 'purple'},\n        {'interval': 3.9, 'color': 'darkorchid'},\n        {'interval': 6.1, 'color': 'mediumpurple'},\n        {'interval': 7.2, 'color': 'lightskyblue'},\n        {'interval': 8.3, 'color': 'khaki'},\n        {'interval': 9.4, 'color': 'orange'},\n        {'interval': 10.5, 'color': 'salmon'},\n        {'interval': 11.6, 'color': 'indianred'},\n        {'interval': 15,'color': 'darkred'}\n      ];\n      \n      const width = 917,\n            height = 408,\n            margins = {top:20, right: 50, bottom: 100, left: 100};\n      \n      const yScale = d3.scaleLinear()\n        .range([height,0])\n        .domain([12,0]);\n      \n      const xScale = d3.scaleLinear()\n        .range([0,width])\n        .domain(d3.extent(data, d => {return d.year; }));\n      \n      //Setting chart width and adjusting for margins\n      const chart = d3.select('.chart')\n        .attr('width', width + margins.right + margins.left)\n        .attr('height', height + margins.top + margins.bottom)\n        .append('g')\n        .attr('transform','translate(' + margins.left + ',' + margins.top + ')');\n      \n      const tooltip = d3.select('.container').append('div')\n        .attr('class','tooltip')\n        .html('Tooltip')\n      \n      const barWidth = width / (yearRange[1] - yearRange[0]),\n            barHeight = height / 12;\n      \n      //Return dynamic color based on intervals in legendData\n      const colorScale = d => {\n        for (let i = 0; i < legendData.length; i++) {\n          if (d.variance + baseTemperature < legendData[i].interval) {\n            return legendData[i].color;\n          }\n        }\n        return 'darkred';\n      };\n      \n      //Return abbreviate month string from month decimal\n      const timeParseFormat = d => {\n        if (d === 0) return '';\n        return d3.timeFormat('%b')(d3.timeParse('%m')(d));\n      };\n      \n      //Append heatmap bars, styles, and mouse events\n      chart.selectAll('g')\n        .data(data).enter().append('g')\n        .append('rect')\n        .attr('x', d => {return (d.year - yearRange[0]) * barWidth})\n        .attr('y', d => {return (d.month - 1) * barHeight})\n        .style('fill', colorScale)\n        .attr('width', barWidth)\n        .attr('height', barHeight)\n        .on('mouseover', d => {\n          tooltip.html(timeParseFormat(d.month) + ' ' + d.year + '<br/>' +\n            d3.format('.4r')(baseTemperature + d.variance) + ' &degC<br/>' + d.variance + ' &degC' )\n            .style('left', d3.event.pageX - 35 + 'px')\n            .style('top', d3.event.pageY - 73 + 'px')\n            .style('opacity', .9);\n        }).on('mouseout', () => {\n          tooltip.style('opacity', 0)\n            .style('left', '0px');\n        });\n      \n      //Append x axis\n      chart.append('g')\n        .attr('transform','translate(0,' + height + ')')\n        .call(d3.axisBottom(xScale).tickFormat(d3.format('.4')));\n      \n      //Append y axis\n      chart.append('g')\n        .attr('transform','translate(0,-' + barHeight / 2 + ')')\n        .call(d3.axisLeft(yScale).tickFormat(timeParseFormat))\n        .attr('class','yAxis');\n      \n      //Append y axis label\n      chart.append('text')\n        .attr('transform','translate(-40,' + (height / 2)  + ') rotate(-90)')\n        .style('text-anchor','middle')\n        .text('Month');\n      \n      //Append x axis label\n      chart.append('text')\n        .attr('transform','translate(' + (width / 2) + ',' + (height + 40) + ')')\n        .style('text-anchor','middle')\n        .text('Year');\n      \n      //Append color legend using legendData\n      chart.append('g')\n        .selectAll('g')\n        .data(legendData).enter()\n        .append('rect')\n        .attr('width', 30)\n        .attr('height', 20)\n        .attr('x', (d, i) => { return i * 30 + width * .7;})\n        .attr('y', height + margins.top)\n        .style('fill', d => {return d.color; });\n      \n      //Append text labels for legend from legendData\n      chart.append('g')\n        .selectAll('text')\n        .data(legendData).enter().append('text')\n        .attr('x', (d,i) => {return i * 30 + width * .7})\n        .attr('y', height + margins.top * 3)\n        .text(d => {return d.interval; });\n        \n    });\n  }, []);\n\n  return (\n    <Fragment>\n      <h1>Heatmap</h1>\n    </Fragment>\n  );\n};\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <Heatmap />\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}